<app-header></app-header>
<div class="min-h-screen flex flex-col">

<main class="container-7xl py-6">
  <h1 class="text-2xl font-semibold mb-4">Carro</h1>

  <div class="grid gap-6 lg:grid-cols-[1fr_320px]">
    <!-- Lista -->
    <div class="bg-white rounded-2xl shadow divide-y" *ngIf="(items$ | async) as items; else empty">
      <div class="p-4 flex items-center gap-4" *ngFor="let it of items">
        <img [src]="it.product.imageUrl" class="w-16 h-16 object-contain rounded" />
        <div class="flex-1">
          <div class="font-medium leading-tight">{{ it.product.name }}</div>
          <div class="text-sm text-stone-500">$ {{ it.product.price | number:'1.0-0' }}</div>
        </div>
        <div class="flex items-center gap-2">
          <button class="px-3 py-1 rounded bg-stone-200" (click)="dec(it)">-</button>
          <span class="w-8 text-center">{{ it.qty }}</span>
          <button class="px-3 py-1 rounded bg-stone-200" (click)="inc(it)">+</button>
        </div>
        <button class="ml-4 text-sm underline" (click)="remove(it)">Quitar</button>
      </div>
      <div class="p-4 text-right">
        <button class="text-sm underline" (click)="clear()">Vaciar carrito</button>
      </div>
    </div>

    <!-- Resumen -->
    <aside class="bg-white rounded-2xl shadow p-4 h-fit">
      <h2 class="font-semibold mb-3">Resumen</h2>
      <div class="flex justify-between py-1">
        <div>Subtotal</div>
        <div>$ {{ total() | number:'1.0-0' }}</div>
      </div>
      <div class="flex justify-between py-1">
        <div>Descuentos</div>
        <div>$ 0</div>
      </div>
      <div class="border-t my-3"></div>
      <div class="flex justify-between font-semibold">
        <div>Total</div>
        <div>$ {{ total() | number:'1.0-0' }}</div>
      </div>
      <button class="px-4 py-2 rounded bg-blue-600 text-white disabled:opacity-50" (click)="reserve()"
        [disabled]="(items$ | async)?.length === 0">
        Reservar
      </button>
    </aside>
  </div>

  <ng-template #empty>
    <div class="text-stone-500">Tu carrito está vacío.</div>
  </ng-template>
</main>

<app-footer class="mt-auto"></app-footer>
</div>